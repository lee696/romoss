<extend name="Public:base" />
<block name="main">
    <style>
        .order-box{background: #f3f5f9;}
        .oder-status{background: #fff; margin-bottom:1.05rem;padding:1.9rem 1.5rem 1.7rem 1.5rem;font-size: 1.4rem;color:#a4aec3; }
        .oder-status span{background: #fff;font-size: 1.1rem;color:#ed5f86;}
        .post-info{ background: #fff; margin-bottom:1.05rem; padding:1.4rem 1rem 1.5rem 1.5rem; font-size: 1.4rem;color:#a4aec3;}
        .post-info h4{font-size: 1.4rem;border-bottom: 1px #cfd6e4 solid;padding-bottom: 0.5rem;color:#414d58;}
        .post-info .ps-info{padding-left: 2.2rem;border-bottom: 1px #cfd6e4 solid;padding-bottom: 1.5rem;position: relative;}
        .post-info .ps-info img{position: absolute;display: block;width: 2rem;height: 2rem;top:1.8rem;left:-0.4rem;}
        .post-info .ps-info .receive-info{ font-size: 1.42rem;line-height:1.5rem;margin-top:2rem;color: #a4aec3;}
        .post-info .ps-info .receive-info span{color: #414d58; }
        .post-info .ps-info .address-infor{font-size: 1.42rem; color: #a4aec3;}
        .post-info .ps-info .address-infor span{color: #414d58;}
        .post-info .logistics{ font-size: 1.4rem;color: #a4aec3;padding-left: 2.2rem;margin-top: 1.5rem;}
        .post-info .logistics a{ float: right;display: block;width: 0.55rem; height: 1rem;background:url(../static/wx/images/icon-right.png) no-repeat;background-size: 100% 100%;margin-top: 0.8rem;}
        .shopping-list{background: #fff; margin-bottom:1.05rem;padding:1.4rem 0 1rem 0; font-size: 1.4rem;color:#a4aec3;}
        .shopping-list h4{font-size: 1.4rem;border-bottom: 1px #cfd6e4 solid;padding-bottom: 0.5rem; margin-right: 1rem; margin-left: 1.55rem;color:#414d58;}
        .shopping-list .dianpu{padding: 0.5rem 0 0.8rem 1.25rem;}
        .shopping-list .dianpu span{display: inline-block;width:1.7rem;height:1.7rem;position: relative;top:0.4rem;background:#20b7f4;margin-right: 1.25rem;}
        .shopping-list .shopping-list-cont{background:#f3f5f9;padding:0.75rem 1.5rem 0 1.1rem;}
        .shopping-list .shopping-list-cont .list-cont-box{padding-bottom: 1rem;}
        .shopping-list .shopping-list-cont .list-cont-box .goods_ico{width:7.5rem;height: 10rem;background: #fff;float: left;}
        .shopping-list .shopping-list-cont .list-cont-box .goods_ico img{margin: 1.4rem auto;display: block;width: 4rem;height: 7.35rem;}
        .shopping-list .shopping-list-cont .list-cont-box .goods-dec{float: right;width: 26rem;font-size: 1.3rem;color: #414d58;}
        .shopping-list .shopping-list-cont .list-cont-box .goods-dec .goods-pris{margin-top: 1.5rem;}
        .shopping-list .shopping-list-cont .list-cont-box .goods-dec .goods-pris span{float: right;}
        .leave-msg{background: #fff;margin-bottom:1.05rem;padding:1.4rem 1rem 1.5rem 1.5rem;font-size: 1.4rem;color:#a4aec3;}
        .leave-msg h4{font-size: 1.4rem;border-bottom: 1px #cfd6e4 solid;padding-bottom: 0.5rem;color:#414d58;}
        .leave-msg p{
            margin-top: 1.5rem;
            font-size: 1.4rem;
            color: #414d58;
        }
        .order-msg{
            background: #fff;
            margin-bottom:1.05rem;
            padding:1.4rem 1rem 1.5rem 1.5rem;
            font-size: 1.4rem;
            color:#a4aec3;
        }
        .order-msg h4{
            font-size: 1.4rem;
            border-bottom: 1px #cfd6e4 solid;
            padding-bottom: 0.5rem;
            color:#414d58;
        }
        .order-msg p{
            margin-top: 1.5rem;
            font-size: 1.4rem;
            color: #414d58;
        }
        .order-msg p span{
            float:right;
            text-align: right;
            color:#a4aec3;
        }
        .order-prs{
            background: #fff;
            margin-bottom:1.05rem;
            padding:1.4rem 1rem 1.5rem 1.5rem;
            font-size: 1.4rem;
            color:#a4aec3;
        }
        .order-prs h4{
            font-size: 1.4rem;
            border-bottom: 1px #cfd6e4 solid;
            padding-bottom: 0.5rem;
            color:#414d58;
        }
        .order-prs p{
            margin-top: 1.5rem;
            font-size: 1.4rem;
            color: #414d58;
        }
        .order-prs p span{
            float:right;
            text-align: right;
            color:#a4aec3;
        }
        .order-prs .total span{
            color: #ed5f86;
            font-size: 1.6rem;
        }
        .submit-bt .oder-cancel{box-sizing: border-box;border: 1px #d7d7d7 solid;float: left;height:5rem;line-height:5rem;text-align: center;font-size:1.8rem;color:#414d58;width: 50%;background: #fff; }
        .submit-bt .oder-confirm{float: right;height:5rem;line-height:5rem;text-align: center;font-size:1.8rem;color: #fff;width: 50%;background-color: #31a9ff;background: -webkit-linear-gradient(left, #31a9ff, #2bd0ff);background: -o-linear-gradient(right, #31a9ff, #2bd0ff);    background: -moz-linear-gradient(right, #31a9ff, #2bd0ff);background: linear-gradient(to right, #31a9ff, #2bd0ff); }
        #float_box{
            background: rgba(0,0,0,0.6);
            position: fixed;
            top:0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 999;
        }
        #float_box .float_box_cont{
            padding-top: 3.6rem;
            margin-top: 70%;
            margin-left: 10%;
            background: #fff;
            width: 30rem;
            height: 13rem;
            border-radius: 1rem;
        }
        #float_box .float_box_cont p{
            font-size: 1.9rem;
            text-align: center;
            color: #414d58;
        }
        #float_box .float_box_cont>div{
            margin-top: 1.5rem;
        }
        #float_box .float_box_cont>div>div{
            height: 4.5rem;
            line-height: 4.5rem;
            text-align: center;
            font-size: 1.6rem;
            color: #a4aec3;
            width: 50%;
            border-top:1px #d7d7d7 solid
        }
        #float_box .float_box_cont>div .c-cancsl{
            float: left;
            border-right:1px #d7d7d7 solid;
        }
        #float_box .float_box_cont>div .c-confirm{
            float: right;
            color: #31a9ff;

        }
        .submit-bt .oder-confirm{
            /* float: left; */
        }
    </style>
    <div class="header-panel">
        <a href="{:U('index')}" class="go-back"></a>订单详情
    </div>
    <div class="order-box" style='margin-top: 3.5rem;margin-bottom: 4.9rem;'>
        <div class="oder-status">
            <p>订单状态：<switch name="info.status" >
                        <case value="1">等待买家付款</case>
                        <case value="2">已付款，等待发货</case>
                        <case value="3">已发货</case>
                        <case value="4">已收货</case>
                        <case value="5">已取消</case>
                        <case value="6">已完成</case>
                        <default />未知
                        </switch><span></span></p>

        </div>
        <div class="post-info">
            <h4><if condition="$info['shipping_type']==2">自提信息 <else/> 配送信息 </if></h4>
            <div class="ps-info">
                <img src="../static/wx/images/icon-gprs.png" />
                <p class="receive-info"><if condition="$info['shipping_type']==2">店铺名称 <else/> 收货人 </if>：<span>{$info.consignee}-{$info.phone}</span></p>
                <p class="address-infor"><if condition="$info['shipping_type']==2">自提地址 <else/> 收货地址 </if>：<br/><span>{$info.address}</span></p>
            </div>
            <if condition="$info['shipping_type']==2">
              <if condition="$info['order_code']">
              <div class="ps-info">
                <img src="../static/wx/images/pick.png" style='top: -0.4rem;' />
              <p class="receive-info" >提货验证码:{$info.order_code}</p>
              <p class="address-infor" >提货验证码用于到店提货给店员核销</p>
              </div>
              <else/>
              <div class="ps-info">
                <img src="../static/wx/images/pick.png" style='top: -0.4rem;' />
              <p class="receive-info" >暂无提货信息</p>
              </div>
              </if>
              <else/>
              <p class="logistics" ><if condition="$info['expressno']">{$express.name}:{$info.expressno}<a href="{:U('Order/logistics',array('oid'=>$info['order_id']))}"></a><else/>暂无物流信息</if></p>
            </if>
        </div>
        <div class="shopping-list">
            <h4>购物清单</h4>
            <div class="dianpu"><span></span>罗马仕</div>
            <div class="shopping-list-cont">
                <div class="list-cont-box clr">
                    <div class="goods_ico">
                        <img src="{$info.goods.goods_img}" />
                    </div>
                    <div class="goods-dec">
                        <p>{$info.goods.goods_name}</p>
                        <p class="goods-pris">￥{$info.goods.price} <span>X{$info.goods_num}</span></p>
                    </div>
                </div>
            </div>

        </div>

        <div class="leave-msg">
            <h4>买家留言</h4>
            <p>
                {$info.mark}
            </p>
        </div>

        <div class="order-msg">
            <h4>订单信息</h4>
            <p>订单编号：<span>{$info.order_num}</span></p>
            <p>创建时间：<span>{$info.create_time|date='Y-m-d H:s:i',###}</span></p>
            <p>支付时间：<span><if condition="$info['pay_time'] gt 0">{$info.pay_time|date='Y-m-d H:s:i',###}</if></span></p>
            <p><if condition="$info['shipping_type']==2">提货时间：<span><if condition="$info['shipping_time'] gt 0">{$info.get_time|date='Y-m-d H:s:i',###}</if></span> <else/> 发货时间：<span><if condition="$info['shipping_time'] gt 0">{$info.shipping_time|date='Y-m-d H:s:i',###}</if></span> </if></p>
        </div>

        <div class="order-prs">
            <h4>订单金额</h4>
            <p>商品金额：<span>￥{$info.goods_fee}</span></p>
            <p>运费：<span>￥{$info.shipping_fee}</span></p>
            <p class="total">订单总计：<span>￥{$info.price}</span></p>
        </div>
<div class="submit-bt clr">
      <switch name="info.status" >
                    <case value="1">
                      <div id="oder-cancel" class="oder-cancel">取消订单</div>
        <div class="oder-confirm" id='oder-confirm'>付款</div>
                        
                    </case>
                        <case value="2"><a class="fixed-bottom-btn" href="#">等待发货</a></case>
                        <case value="3">
                            <a class="fixed-bottom-btn" href="{:U('Order/logistics',array('oid'=>$info['order_id']))}">查看物流</a>
                            <a class="fixed-bottom-btn" href="{:U('Order/evaluate',array('oid'=>$info['order_id']))}">确认收货</a>
                        </case>
                        <case value="4"><a class="fixed-bottom-btn" href="{:U('Order/evaluate',array('oid'=>$info['order_id']))}">评价</a></case>
                        <case value="5">
                         
                          <div id="oder-buy" class="oder-confirm">再次购买</div>
         <div  id='oder-del' class="oder-cancel">删除订单</div>
                        </case>
                        <case value="6">
                           <div id="oder-buy" class="oder-confirm">再次购买</div>
         <div  id='oder-del' class="oder-cancel">删除订单</div>
                        </case>
                        <default />未知
                        </switch>
        
    </div>
    </div>
    
    <div id='float_box' class="none">
        <div class="float_box_cont">
            <p>确认取消订单？</p>
            <div>
                <div class="c-cancsl">取消</div>
                 <div class="c-confirm" >确定</div>
            </div>
        </div>
    </div>
</block>
<block name="js-con">
    <script>
        $(function () {
            $("#oder-cancel").click(function () {
                $("#float_box").show();
            });
             $("#oder-confirm").click(function () {
                location.href ="{:U('Order/paytype','',true,true)}?oid="+{$info.order_id};
            });
            $("#oder-buy").click(function () {
                location.href ="{:U('Goods/index','',true,true)}?goods_id="+{$info.goods.goods_id};
            });
            $("#oder-del").click(function () {
                location.href ="{:U('Order/del','',true,true)}?oid="+{$info.order_id};
            });

            $("#float_box .c-cancsl").click(function () {
                $("#float_box").hide();
            });
            $("#float_box .c-confirm").click(function () {
               $("#float_box").hide();
              location.href ="{:U('Order/cancel','',true,true)}?oid="+{$info.order_id};
            });

        });
    </script>
</block>
